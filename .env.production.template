# =============================================================================
# DEX MOBILE V6 - PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env.production and fill in the actual values
# DO NOT commit the actual .env.production file to version control

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================
NODE_ENV=production
ENVIRONMENT=production
LOG_LEVEL=info
DEBUG=false

# =============================================================================
# AWS CONFIGURATION
# =============================================================================
AWS_REGION=us-west-2
AWS_ACCOUNT_ID=your-aws-account-id

# =============================================================================
# DATABASE CONFIGURATION (RDS PostgreSQL)
# =============================================================================
# These values should be retrieved from AWS Secrets Manager in production
POSTGRES_HOST=production-dex-postgres.cluster-xxxxx.us-west-2.rds.amazonaws.com
POSTGRES_PORT=5432
POSTGRES_DB=dex_mobile
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-secure-database-password
POSTGRES_URL=postgresql://postgres:your-secure-database-password@production-dex-postgres.cluster-xxxxx.us-west-2.rds.amazonaws.com:5432/dex_mobile
POSTGRES_SSL=true
POSTGRES_MAX_CONNECTIONS=20
POSTGRES_IDLE_TIMEOUT=30000
POSTGRES_CONNECTION_TIMEOUT=60000

# =============================================================================
# REDIS CONFIGURATION (ElastiCache)
# =============================================================================
REDIS_HOST=production-dex-redis.xxxxx.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD=your-secure-redis-password
REDIS_URL=redis://:your-secure-redis-password@production-dex-redis.xxxxx.cache.amazonaws.com:6379
REDIS_DB=0
REDIS_KEY_PREFIX=dex_mobile:
REDIS_TTL=3600
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000

# =============================================================================
# SUPABASE CONFIGURATION
# =============================================================================
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# =============================================================================
# MICROSERVICES PORTS
# =============================================================================
BLOCKCHAIN_SERVICE_PORT=5001
KYC_SERVICE_PORT=4001
AML_SERVICE_PORT=4002
CHART_API_SERVICE_PORT=4000
MONITORING_SERVICE_PORT=3001

# =============================================================================
# BLOCKCHAIN SERVICE CONFIGURATION
# =============================================================================
# Ethereum Mainnet
ETHEREUM_RPC_URL=https://mainnet.infura.io/v3/your-infura-project-id
ETHEREUM_CHAIN_ID=1
ETHEREUM_BLOCK_CONFIRMATIONS=12

# Polygon Mainnet
POLYGON_RPC_URL=https://polygon-mainnet.infura.io/v3/your-infura-project-id
POLYGON_CHAIN_ID=137
POLYGON_BLOCK_CONFIRMATIONS=20

# Binance Smart Chain
BSC_RPC_URL=https://bsc-dataseed.binance.org/
BSC_CHAIN_ID=56
BSC_BLOCK_CONFIRMATIONS=3

# Arbitrum One
ARBITRUM_RPC_URL=https://arb1.arbitrum.io/rpc
ARBITRUM_CHAIN_ID=42161
ARBITRUM_BLOCK_CONFIRMATIONS=1

# Blockchain Service Settings
BLOCKCHAIN_REQUEST_TIMEOUT=30000
BLOCKCHAIN_MAX_RETRIES=3
BLOCKCHAIN_CIRCUIT_BREAKER_THRESHOLD=10
BLOCKCHAIN_CIRCUIT_BREAKER_TIMEOUT=60000

# =============================================================================
# KYC SERVICE CONFIGURATION
# =============================================================================
# IDfy API Configuration
IDFY_API_KEY=your-idfy-api-key
IDFY_BASE_URL=https://eve.idfy.com/v3.0/api
IDFY_ACCOUNT_ID=your-idfy-account-id
IDFY_WEBHOOK_SECRET=your-idfy-webhook-secret

# KYC Settings
KYC_DOCUMENT_UPLOAD_MAX_SIZE=10485760  # 10MB
KYC_DOCUMENT_ALLOWED_TYPES=image/jpeg,image/png,application/pdf
KYC_VERIFICATION_TIMEOUT=300000  # 5 minutes
KYC_MAX_RETRY_ATTEMPTS=3

# =============================================================================
# AML SERVICE CONFIGURATION
# =============================================================================
# Signzy API Configuration (Alternative AML provider)
SIGNZY_API_KEY=your-signzy-api-key
SIGNZY_BASE_URL=https://preproduction.signzy.tech/api/v2
SIGNZY_WEBHOOK_SECRET=your-signzy-webhook-secret

# AML Settings
AML_SCREENING_TIMEOUT=120000  # 2 minutes
AML_RISK_THRESHOLD=75
AML_PERIODIC_SCREENING_INTERVAL=2592000000  # 30 days in milliseconds

# =============================================================================
# CHART API SERVICE CONFIGURATION
# =============================================================================
# CoinGecko API Configuration
COINGECKO_API_KEY=your-coingecko-api-key
COINGECKO_BASE_URL=https://api.coingecko.com/api/v3
COINGECKO_RATE_LIMIT_PER_MINUTE=50
COINGECKO_TIMEOUT_MS=10000

# Chart API Settings
CHART_CACHE_TTL_SECONDS=300
CHART_CACHE_MAX_SIZE=1000
CHART_RATE_LIMIT_WINDOW_MS=60000
CHART_RATE_LIMIT_MAX_REQUESTS=100
CHART_CIRCUIT_BREAKER_THRESHOLD=5
CHART_CIRCUIT_BREAKER_TIMEOUT_MS=60000

# =============================================================================
# MONITORING SERVICE CONFIGURATION
# =============================================================================
MONITORING_HEALTH_CHECK_INTERVAL=30000
MONITORING_ALERT_THRESHOLD_CPU=80
MONITORING_ALERT_THRESHOLD_MEMORY=85
MONITORING_ALERT_THRESHOLD_DISK=90
MONITORING_SERVICES_TO_MONITOR=kyc-service:4001,aml-service:4002,chart-api-service:4000,blockchain-service:5001

# Prometheus Configuration
PROMETHEUS_URL=http://prometheus:9090
PROMETHEUS_SCRAPE_INTERVAL=15s
PROMETHEUS_RETENTION_TIME=30d

# Grafana Configuration
GRAFANA_URL=http://grafana:3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=your-secure-grafana-password

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Encryption Keys (32 characters each)
ENCRYPTION_KEY=your-32-character-encryption-key-here
JWT_SECRET=your-jwt-secret-key-here
JWT_REFRESH_SECRET=your-jwt-refresh-secret-key-here
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# API Security
API_RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
API_RATE_LIMIT_MAX_REQUESTS=100
API_CORS_ORIGIN=https://your-frontend-domain.com
API_CORS_CREDENTIALS=true

# Session Configuration
SESSION_SECRET=your-session-secret-key-here
SESSION_MAX_AGE=86400000  # 24 hours
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================
WEBHOOK_BASE_URL=https://api.your-domain.com
WEBHOOK_SECRET=your-webhook-secret-key
WEBHOOK_TIMEOUT=30000
WEBHOOK_MAX_RETRIES=3

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Email Configuration (SES)
EMAIL_FROM=noreply@your-domain.com
EMAIL_REPLY_TO=support@your-domain.com
SES_REGION=us-west-2

# SMS Configuration (SNS)
SMS_REGION=us-west-2
SMS_SENDER_ID=DEX-Mobile

# Slack Notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/slack/webhook
SLACK_CHANNEL=#dex-alerts
SLACK_USERNAME=DEX-Bot

# =============================================================================
# EXTERNAL API CONFIGURATION
# =============================================================================
# Third-party API timeouts and retries
EXTERNAL_API_TIMEOUT=30000
EXTERNAL_API_MAX_RETRIES=3
EXTERNAL_API_RETRY_DELAY=1000

# Rate limiting for external APIs
EXTERNAL_API_RATE_LIMIT=100
EXTERNAL_API_RATE_WINDOW=60000

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_FORMAT=json
LOG_TIMESTAMP=true
LOG_COLORIZE=false
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10
LOG_DATE_PATTERN=YYYY-MM-DD

# CloudWatch Logs
CLOUDWATCH_LOG_GROUP=/aws/dex-mobile/production
CLOUDWATCH_LOG_STREAM=production-logs
CLOUDWATCH_LOG_REGION=us-west-2

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Node.js Performance
NODE_OPTIONS=--max-old-space-size=2048
UV_THREADPOOL_SIZE=128

# Connection Pooling
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_ACQUIRE_TIMEOUT=60000

# Cache Configuration
CACHE_DEFAULT_TTL=3600
CACHE_MAX_KEYS=10000
CACHE_CHECK_PERIOD=600

# =============================================================================
# COMPLIANCE CONFIGURATION
# =============================================================================
# Data Retention (in days)
DATA_RETENTION_PERIOD=2555  # 7 years for financial compliance
LOG_RETENTION_PERIOD=90
AUDIT_LOG_RETENTION_PERIOD=2555

# Compliance Features
ENABLE_AUDIT_LOGGING=true
ENABLE_DATA_ENCRYPTION=true
ENABLE_PII_MASKING=true
ENABLE_GDPR_COMPLIANCE=true

# =============================================================================
# FEATURE FLAGS
# =============================================================================
ENABLE_SWAGGER_DOCS=false
ENABLE_METRICS_ENDPOINT=true
ENABLE_HEALTH_CHECKS=true
ENABLE_GRACEFUL_SHUTDOWN=true
ENABLE_REQUEST_LOGGING=true
ENABLE_ERROR_TRACKING=true

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================
DEPLOYMENT_ENVIRONMENT=production
DEPLOYMENT_VERSION=1.0.0
DEPLOYMENT_BUILD_NUMBER=latest
DEPLOYMENT_COMMIT_SHA=latest

# Container Configuration
CONTAINER_MEMORY_LIMIT=2048m
CONTAINER_CPU_LIMIT=1000m
CONTAINER_RESTART_POLICY=always

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================
# Alert Thresholds
ALERT_CPU_THRESHOLD=80
ALERT_MEMORY_THRESHOLD=85
ALERT_DISK_THRESHOLD=90
ALERT_ERROR_RATE_THRESHOLD=5
ALERT_RESPONSE_TIME_THRESHOLD=2000

# Alert Destinations
ALERT_EMAIL=alerts@your-domain.com
ALERT_SLACK_WEBHOOK=https://hooks.slack.com/services/your/alert/webhook
ALERT_PAGERDUTY_KEY=your-pagerduty-integration-key

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=production-dex-backups
BACKUP_ENCRYPTION_ENABLED=true

# =============================================================================
# LOAD BALANCER CONFIGURATION
# =============================================================================
LB_HEALTH_CHECK_PATH=/health
LB_HEALTH_CHECK_INTERVAL=30
LB_HEALTH_CHECK_TIMEOUT=5
LB_HEALTHY_THRESHOLD=2
LB_UNHEALTHY_THRESHOLD=3

# =============================================================================
# AUTO SCALING CONFIGURATION
# =============================================================================
AUTOSCALING_MIN_CAPACITY=2
AUTOSCALING_MAX_CAPACITY=20
AUTOSCALING_TARGET_CPU=70
AUTOSCALING_TARGET_MEMORY=80
AUTOSCALING_SCALE_OUT_COOLDOWN=300
AUTOSCALING_SCALE_IN_COOLDOWN=300
